(window.webpackJsonpfigure=window.webpackJsonpfigure||[]).push([[0],{15:function(e,t,n){e.exports=n(36)},31:function(e,t,n){},32:function(e,t,n){},33:function(e,t,n){},34:function(e,t,n){},35:function(e,t,n){},36:function(e,t,n){"use strict";n.r(t);n(16);var a,i,r=n(2),c=n.n(r),o=n(10),s=n.n(o),u=n(0),l=n(11),g=n(12),d=new(function(){function e(){Object(l.a)(this,e),this.STORAGE_NAME="CANVAS"}return Object(g.a)(e,[{key:"setValue",value:function(e){window.localStorage.setItem(this.STORAGE_NAME,JSON.stringify(e))}},{key:"getValue",value:function(){var e=window.localStorage.getItem(this.STORAGE_NAME);return e?JSON.parse(e):void 0}}]),e}());!function(e){e.DISABLE="disable",e.LEFT_TOP="left-top",e.LEFT_BOT="left-bottom",e.RIGHT_TOP="right-top",e.RIGHT_BOT="right-bottom"}(a||(a={})),function(e){e.CIRCLE="circle",e.SQUARE="square",e.TRIANGLE="triangle"}(i||(i={}));var h=n(13),f=n.n(h),v=u.x.model({id:u.x.identifier,left:u.x.number,top:u.x.number,width:u.x.number,height:u.x.number,type:u.x.enumeration(Object.values(i))}),p=u.x.model({figures:u.x.array(v),selectedFigureId:u.x.maybeNull(u.x.string),width:u.x.optional(u.x.number,800),height:u.x.optional(u.x.number,600),isDragging:u.x.optional(u.x.boolean,!1),resizingType:u.x.optional(u.x.enumeration(Object.values(a)),a.DISABLE),minFigureWidth:u.x.optional(u.x.number,100),minFigureHeight:u.x.optional(u.x.number,100),figureTypes:u.x.optional(u.x.array(u.x.enumeration(Object.values(i))),Object.values(i))}).actions(function(e){return{addFigure:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:150,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:150,i={id:f()(),type:t,width:n,height:a,left:e.width/2-n/2,top:e.height/2-a/2};return e.figures.push(i),e.selectedFigureId=i.id,i},selectFigure:function(t){e.selectedFigureId=t},moveSelectedFigure:function(t,n){var a=e.figures.find(function(t){return t.id===e.selectedFigureId});if(a){var i=a.left+t;i<0&&(i=0),i>e.width-a.width&&(i=e.width-a.width),a.left=i;var r=a.top+n;r<0&&(r=0),r>e.height-a.height&&(r=e.height-a.height),a.top=r}},deleteSelectedFigure:function(){var t=e.figures.find(function(t){return t.id===e.selectedFigureId});t&&(Object(u.h)(t),e.selectedFigureId=null)},setIsDragging:function(t){e.isDragging=t},setResizingType:function(t){e.resizingType=t},stopResizing:function(){e.resizingType=a.DISABLE},resizeSelectedFigure:function(t,n){var i=e.figures.find(function(t){return t.id===e.selectedFigureId});if(i&&(t||n)){var r={left:i.left,top:i.top,width:i.width,height:i.height};switch(e.resizingType){case a.LEFT_TOP:r.left+=t,r.top+=n,r.width-=t,r.height-=n;break;case a.LEFT_BOT:r.left+=t,r.width-=t,r.height+=n;break;case a.RIGHT_TOP:r.top+=n,r.width+=t,r.height-=n;break;case a.RIGHT_BOT:r.width+=t,r.height+=n;break;case a.DISABLE:return}r.left<0||r.top<0||r.left+r.width>e.width||r.top+r.height>e.height||r.width<e.minFigureWidth||r.height<e.minFigureHeight||(i.left=r.left,i.top=r.top,i.width=r.width,i.height=r.height)}}}}).views(function(e){return{get isResizing(){return e.resizingType!==a.DISABLE}}}),m=u.x.model(p.properties),b=u.x.model({snapShots:u.x.array(m),activeSnapIndex:u.x.optional(u.x.number,0)}).views(function(e){return{get canBack(){return!!e.activeSnapIndex},get canForward(){return e.activeSnapIndex+1<e.snapShots.length}}}).actions(function(e){return{addSnapShot:function(t){var n=e.activeSnapIndex+1;n<e.snapShots.length&&e.snapShots.splice(n,e.snapShots.length-n),e.snapShots.push(t),e.activeSnapIndex=e.snapShots.length-1,d.setValue(t)},changeIndexBy:function(t){var n=e.activeSnapIndex+t,a=Object(u.m)(e);if(!(n+1>e.snapShots.length)){var i=e.snapShots[n];e.activeSnapIndex=n,Object(u.e)(a.canvas,Object(u.n)(i)),d.setValue(i)}}}}),w=u.x.model({canvas:p,history:b}),y=d.getValue()||{figures:[]},x=w.create({canvas:y,history:{snapShots:[y]}});Object(u.s)(x,function(e){if(Object(u.l)(x.canvas)===e.path){var t=Object(u.n)(x.canvas);t.isDragging||t.resizingType!==a.DISABLE||x.history.addSnapShot(t)}},!0);var E,O=c.a.createContext(x),I=function(){return Object(r.useContext)(O)},S=n(3),T=(n(31),n(4)),_=n.n(T),F=n(14),j=n(6),k=function(e){return c.a.createElement("svg",Object.assign({viewBox:"-1 -1 32 32"},e),c.a.createElement("ellipse",{cx:"15",cy:"15",rx:"15",ry:"15"}))},N=function(e){return c.a.createElement("svg",Object.assign({viewBox:"-1 -1 32 32"},e),c.a.createElement("rect",{width:"30",height:"30"}))},R=function(e){return c.a.createElement("svg",Object.assign({viewBox:"-1 -1 32 32"},e),c.a.createElement("polygon",{points:"15,0 00,30 30,30"}))},B=(E={},Object(j.a)(E,i.SQUARE,N),Object(j.a)(E,i.TRIANGLE,R),Object(j.a)(E,i.CIRCLE,k),E),D=function(e){var t=e.type,n=Object(F.a)(e,["type"]),a=B[t];return a?c.a.createElement(a,n):null},L=(n(32),[{type:a.LEFT_TOP,className:"_left-top"},{type:a.LEFT_BOT,className:"_left-bot"},{type:a.RIGHT_TOP,className:"_right-top"},{type:a.RIGHT_BOT,className:"_right-bot"}]),A=Object(S.a)(function(e){var t=e.figure,n=I(),a=Object(r.useMemo)(function(){return t.id===n.canvas.selectedFigureId},[t.id,n.canvas.selectedFigureId]);return c.a.createElement("div",{key:t.id,style:{width:t.width,height:t.height,transform:"translate3d(\n          ".concat(t.left,"px,\n          ").concat(t.top,"px,\n          0\n        )")},className:_()("figure",{_active:a,_dragging:a&&n.canvas.isDragging}),onClick:function(){a||n.canvas.selectFigure(t.id)},onMouseDown:function(e){e.stopPropagation(),0===e.button&&a&&n.canvas.setIsDragging(!0)}},L.map(function(e){return c.a.createElement("div",{key:e.type,onMouseDown:function(t){return function(e,t){e.stopPropagation(),0===e.button&&a&&n.canvas.setResizingType(t)}(t,e.type)},className:"figure__dot ".concat(e.className)})}),c.a.createElement(D,{type:t.type,preserveAspectRatio:"none",className:"figure__img"}))}),z=Object(S.a)(function(){var e=I(),t=Object(r.useRef)(null);return c.a.createElement("div",{className:"canvas",style:{width:e.canvas.width,height:e.canvas.height},onMouseLeave:function(n){n.currentTarget===t.current&&e.canvas.isDragging&&e.canvas.setIsDragging(!1)},onMouseDown:function(n){n.currentTarget===t.current&&e.canvas.selectedFigureId&&e.canvas.selectFigure(null)},ref:t},e.canvas.figures.map(function(e){return c.a.createElement(A,{key:e.id,figure:e})}))}),M=(n(33),Object(S.a)(function(){var e=I();return c.a.createElement("div",{className:"control-bar"},c.a.createElement("div",{className:"control-bar__figures-list"},e.canvas.figureTypes.map(function(t){return c.a.createElement(D,{key:t,type:t,onClick:function(){return e.canvas.addFigure(t)},className:"control-bar__figure"})})),c.a.createElement("div",{className:"control-bar__nav"},c.a.createElement("div",{onClick:function(){return e.history.changeIndexBy(-1)},className:_()({"control-bar__nav-link":!0,_disabled:!e.history.canBack})},"\u2190 prev"),c.a.createElement("div",{onClick:function(){return e.history.changeIndexBy(1)},className:_()({"control-bar__nav-link":!0,_disabled:!e.history.canForward})},"next \u2192")))})),C=(n(34),Object(S.a)(function(){var e=I(),t=Object(r.useRef)(null),n=function(n){n.currentTarget===t.current&&(e.canvas.isDragging&&e.canvas.setIsDragging(!1),e.canvas.isResizing&&e.canvas.stopResizing())};return Object(r.useEffect)(function(){var t=function(t){e.canvas.selectedFigureId&&("Delete"===t.key&&e.canvas.deleteSelectedFigure(),"Escape"===t.key&&e.canvas.selectFigure(null))};return window.document.addEventListener("keydown",t),function(){window.document.removeEventListener("keydown",t)}},[e.canvas]),c.a.createElement("div",{onMouseMove:function(t){e.canvas.isDragging&&e.canvas.moveSelectedFigure(t.movementX,t.movementY),e.canvas.isResizing&&e.canvas.resizeSelectedFigure(t.movementX,t.movementY)},onMouseUp:n,onMouseLeave:n,className:"main-container",ref:t},c.a.createElement("div",{className:"content"},c.a.createElement(M,null),c.a.createElement(z,null)))})),G=function(){return c.a.createElement(C,null)};n(35),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(c.a.createElement(G,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[15,1,2]]]);
//# sourceMappingURL=main.468176d2.chunk.js.map