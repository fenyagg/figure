(window.webpackJsonpfigure=window.webpackJsonpfigure||[]).push([[0],{10:function(e,t,n){e.exports={canvas:"Canvas_canvas__DJqnh",cursorNW:"Canvas_cursorNW__2BpNg",cursorNE:"Canvas_cursorNE__tf-i_"}},11:function(e,t,n){e.exports={figure:"Figure_figure__edZWV",figureSelected:"Figure_figureSelected__2WLoN",figureInside:"Figure_figureInside__10wBb"}},14:function(e,t,n){e.exports={mainContainer:"Editor_mainContainer__3rUA7",content:"Editor_content__2hEKd"}},20:function(e,t,n){e.exports=n(37)},36:function(e,t,n){},37:function(e,t,n){"use strict";n.r(t);n(21);var i,r,a=n(1),c=n.n(a),s=n(16),o=n.n(s),u=n(3),g=n(0),l=n(17),d=n(18),f=new(function(){function e(){Object(l.a)(this,e),this.STORAGE_NAME="CANVAS"}return Object(d.a)(e,[{key:"saveSnap",value:function(e){window.localStorage.setItem(this.STORAGE_NAME,JSON.stringify(e))}},{key:"getSnap",value:function(){var e=window.localStorage.getItem(this.STORAGE_NAME);return e?JSON.parse(e):{}}}]),e}()),p=["addFigure","deleteSelectedFigure","stopDragging","stopResizing"],h=n(19),v=n.n(h);!function(e){e.DISABLE="disable",e.LEFT_TOP="left-top",e.LEFT_BOT="left-bottom",e.RIGHT_TOP="right-top",e.RIGHT_BOT="right-bottom"}(i||(i={})),function(e){e.CIRCLE="circle",e.SQUARE="square",e.TRIANGLE="triangle"}(r||(r={}));var m=g.x.model({id:g.x.identifier,left:g.x.number,top:g.x.number,width:g.x.number,height:g.x.number,type:g.x.enumeration(Object.values(r))}),F=g.x.model({figures:g.x.array(m),selectedFigureId:g.x.maybeNull(g.x.string),width:g.x.optional(g.x.number,800),height:g.x.optional(g.x.number,600),isDragging:g.x.optional(g.x.boolean,!1),resizingType:g.x.optional(g.x.enumeration(Object.values(i)),i.DISABLE),minFigureWidth:g.x.optional(g.x.number,100),minFigureHeight:g.x.optional(g.x.number,100),figureTypes:g.x.optional(g.x.array(g.x.enumeration(Object.values(r))),Object.values(r))}).views(function(e){return{get isResizing(){return e.resizingType!==i.DISABLE},get selectedFigure(){return e.figures.find(function(t){return t.id===e.selectedFigureId})}}}).views(function(e){return{get activeDotPosition(){if(e.selectedFigure)switch(e.resizingType){case i.LEFT_TOP:return{x:e.selectedFigure.left,y:e.selectedFigure.top};case i.LEFT_BOT:return{x:e.selectedFigure.left,y:e.selectedFigure.top+e.selectedFigure.height};case i.RIGHT_TOP:return{x:e.selectedFigure.left+e.selectedFigure.width,y:e.selectedFigure.top};case i.RIGHT_BOT:return{x:e.selectedFigure.left+e.selectedFigure.width,y:e.selectedFigure.top+e.selectedFigure.height};default:return}}}}).actions(function(e){return{addFigure:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:150,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:150,r={id:v()(),type:t,width:n,height:i,left:e.width/2-n/2,top:e.height/2-i/2};return e.figures.push(r),e.selectedFigureId=r.id,r},selectFigure:function(t){e.selectedFigureId=t},moveSelectedFigure:function(t,n){if(e.selectedFigure){var i=e.selectedFigure.left+t;i<0&&(i=0),i>e.width-e.selectedFigure.width&&(i=e.width-e.selectedFigure.width),e.selectedFigure.left=i;var r=e.selectedFigure.top+n;r<0&&(r=0),r>e.height-e.selectedFigure.height&&(r=e.height-e.selectedFigure.height),e.selectedFigure.top=r}},deleteSelectedFigure:function(){var t=e.figures.find(function(t){return t.id===e.selectedFigureId});t&&(Object(g.h)(t),e.selectedFigureId=null)},startDragging:function(){e.isDragging=!0},stopDragging:function(){e.isDragging=!1},setResizingType:function(t){e.resizingType=t},stopResizing:function(){e.resizingType=i.DISABLE},resizeSelectedFigure:function(t,n){if(e.selectedFigure&&(t||n)){var r={left:e.selectedFigure.left,top:e.selectedFigure.top,width:e.selectedFigure.width,height:e.selectedFigure.height},a=function(i,a,c,s){if(r.left+=t*i,r.top+=n*a,r.width+=t*c,r.height+=n*s,r.left<0&&(r.width+=r.left,r.left=0),r.left+r.width>e.width&&(r.width=e.width-r.left),r.top<0&&(r.height+=r.top,r.top=0),r.top+r.height>e.height&&(r.height=e.height-r.top),r.width<e.minFigureWidth){var o=e.minFigureWidth-r.width;r.width=e.minFigureWidth,r.left+=o*i*-1}if(r.height<e.minFigureHeight){var u=e.minFigureHeight-r.height;r.height=e.minFigureHeight,r.top+=u*a*-1}e.selectedFigure.left=r.left,e.selectedFigure.top=r.top,e.selectedFigure.width=r.width,e.selectedFigure.height=r.height};switch(e.resizingType){case i.LEFT_TOP:a(1,1,-1,-1);break;case i.LEFT_BOT:a(1,0,-1,1);break;case i.RIGHT_TOP:a(0,1,1,-1);break;case i.RIGHT_BOT:a(0,0,1,1);break;case i.DISABLE:return}}}}});function O(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,i)}return n}var b=g.x.model({figures:F.properties.figures}),_=g.x.model({snapShots:g.x.array(b),activeSnapIndex:g.x.optional(g.x.number,0)}).views(function(e){return{get canBack(){return!!e.activeSnapIndex},get canForward(){return e.activeSnapIndex+1<e.snapShots.length}}}).actions(function(e){return{addSnapShot:function(t){var n=e.activeSnapIndex+1;n<e.snapShots.length&&e.snapShots.splice(n,e.snapShots.length-n),e.snapShots.push(t),e.activeSnapIndex=e.snapShots.length-1,f.saveSnap(e.snapShots[e.activeSnapIndex])},changeIndexBy:function(t){var n=e.activeSnapIndex+t,i=Object(g.m)(e);if(!(n+1>e.snapShots.length)){var r=e.snapShots[n],a=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?O(n,!0).forEach(function(t){Object(u.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):O(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({},Object(g.n)(i.canvas),{},Object(g.n)(r));e.activeSnapIndex=n,Object(g.e)(i.canvas,a),f.saveSnap(r)}}}});function y(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,i)}return n}var w=g.x.model({canvas:F,history:_}),E=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?y(n,!0).forEach(function(t){Object(u.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):y(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({figures:[]},f.getSnap()),T=w.create({canvas:E,history:{snapShots:[E]}});Object(g.s)(T,function(e){if(Object(g.l)(T.canvas)===e.path&&p.includes(e.name)){var t=Object(g.n)(T.canvas);T.history.addSnapShot(t)}},!0);var j,x=c.a.createContext(T),S=function(){return Object(a.useContext)(x)},I=n(4),D=n(10),N=n.n(D),C=n(5),k=n.n(C),B=n(8),L=function(e){var t=e.onClickInside,n=e.insideClassName,i=Object(B.a)(e,["onClickInside","insideClassName"]);return c.a.createElement("svg",Object.assign({viewBox:"-1 -1 32 32"},i),c.a.createElement("ellipse",{className:n,onClick:t,cx:"15",cy:"15",rx:"15",ry:"15"}))},R=function(e){var t=e.onClickInside,n=e.insideClassName,i=Object(B.a)(e,["onClickInside","insideClassName"]);return c.a.createElement("svg",Object.assign({viewBox:"-1 -1 32 32"},i),c.a.createElement("rect",{className:n,onClick:t,width:"30",height:"30"}))},P=function(e){var t=e.onClickInside,n=e.insideClassName,i=Object(B.a)(e,["onClickInside","insideClassName"]);return c.a.createElement("svg",Object.assign({viewBox:"-1 -1 32 32"},i),c.a.createElement("polygon",{className:n,onClick:t,points:"15,0 00,30 30,30"}))},z=(j={},Object(u.a)(j,r.SQUARE,R),Object(u.a)(j,r.TRIANGLE,P),Object(u.a)(j,r.CIRCLE,L),j),A=function(e){var t=e.type,n=Object(B.a)(e,["type"]),i=z[t];return i?c.a.createElement(i,n):null},G=n(11),H=n.n(G),W=Object(I.a)(function(e){var t=e.figure,n=S(),i=Object(a.useMemo)(function(){return t.id===n.canvas.selectedFigureId},[t.id,n.canvas.selectedFigureId]);return c.a.createElement(A,{type:t.type,style:{width:t.width,height:t.height,transform:"translate3d(\n          ".concat(t.left,"px,\n          ").concat(t.top,"px,\n          0\n        )")},preserveAspectRatio:"none",className:k()(H.a.figure,Object(u.a)({},H.a.figureSelected,i)),insideClassName:H.a.figureInside,onClickInside:function(e){i||n.canvas.selectFigure(t.id)}})}),M=n(6),J=n.n(M),U=[{type:i.LEFT_TOP,className:J.a.dotLeftTop},{type:i.LEFT_BOT,className:J.a.dotLeftBot},{type:i.RIGHT_TOP,className:J.a.dotRightTop},{type:i.RIGHT_BOT,className:J.a.dotRightBot}],q=Object(I.a)(function(){var e,t=S(),n=t.canvas.selectedFigure;return n?c.a.createElement("div",{style:{width:n.width,height:n.height,transform:"translate3d(\n          ".concat(n.left,"px,\n          ").concat(n.top,"px,\n          0\n        )")},className:k()(J.a.figureFrame,(e={},Object(u.a)(e,J.a.figureFrameCanDrag,!t.canvas.isResizing),Object(u.a)(e,J.a.figureFrameDragging,t.canvas.isDragging),Object(u.a)(e,J.a.figureFrameIsResizing,t.canvas.isResizing),e)),onMouseDown:function(e){e.stopPropagation(),0===e.button&&t.canvas.startDragging()}},U.map(function(e){return c.a.createElement("div",{key:e.type,onMouseDown:function(n){return function(e,n){e.stopPropagation(),0===e.button&&t.canvas.setResizingType(n)}(n,e.type)},className:k()(J.a.dot,e.className)})})):null}),K=Object(I.a)(function(){var e,t=S(),n=Object(a.useRef)(null);return c.a.createElement("div",{className:k()((e={},Object(u.a)(e,N.a.canvas,!0),Object(u.a)(e,N.a.cursorNW,[i.LEFT_TOP,i.RIGHT_BOT].includes(t.canvas.resizingType)),Object(u.a)(e,N.a.cursorNE,[i.LEFT_BOT,i.RIGHT_TOP].includes(t.canvas.resizingType)),e)),style:{width:t.canvas.width,height:t.canvas.height},onMouseMove:function(e){t.canvas.isDragging&&t.canvas.moveSelectedFigure(e.movementX,e.movementY);var i=t.canvas.activeDotPosition;t.canvas.isResizing&&n.current&&i&&t.canvas.resizeSelectedFigure(e.pageX-n.current.offsetLeft-i.x,e.pageY-n.current.offsetTop-i.y)},onMouseLeave:function(e){e.currentTarget===n.current&&t.canvas.isDragging&&t.canvas.stopDragging()},onMouseDown:function(e){e.currentTarget===n.current&&t.canvas.selectedFigureId&&t.canvas.selectFigure(null)},ref:n},t.canvas.figures.map(function(e){return c.a.createElement(W,{key:e.id,figure:e})}),t.canvas.selectedFigure&&c.a.createElement(q,null))}),Q=n(7),Y=n.n(Q),V=Object(I.a)(function(){var e,t,n=S();return c.a.createElement("div",{className:Y.a.controlBar},c.a.createElement("div",{className:Y.a.figureList},n.canvas.figureTypes.map(function(e){return c.a.createElement(A,{key:e,type:e,onClick:function(){return n.canvas.addFigure(e)},className:Y.a.figure})})),c.a.createElement("div",{className:Y.a.nav},c.a.createElement("div",{onClick:function(){return n.history.changeIndexBy(-1)},className:k()((e={},Object(u.a)(e,Y.a.navLink,!0),Object(u.a)(e,Y.a.navLinkDisabled,!n.history.canBack),e))},"\u2190 prev"),c.a.createElement("div",{onClick:function(){return n.history.changeIndexBy(1)},className:k()((t={},Object(u.a)(t,Y.a.navLink,!0),Object(u.a)(t,Y.a.navLinkDisabled,!n.history.canForward),t))},"next \u2192")))}),X=n(14),Z=n.n(X),$=Object(I.a)(function(){var e=S(),t=Object(a.useRef)(null),n=function(n){n.currentTarget===t.current&&(e.canvas.isDragging&&e.canvas.stopDragging(),e.canvas.isResizing&&e.canvas.stopResizing())};return Object(a.useEffect)(function(){var t=function(t){e.canvas.selectedFigureId&&("Delete"===t.key&&e.canvas.deleteSelectedFigure(),"Escape"===t.key&&e.canvas.selectFigure(null))};return window.document.addEventListener("keydown",t),function(){window.document.removeEventListener("keydown",t)}},[e.canvas]),c.a.createElement("div",{onMouseUp:n,onMouseLeave:n,className:Z.a.mainContainer,ref:t},c.a.createElement("div",{className:Z.a.content},c.a.createElement(V,null),c.a.createElement(K,null)))}),ee=function(){return c.a.createElement($,null)};n(36),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(c.a.createElement(ee,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},6:function(e,t,n){e.exports={figureFrame:"FigureFrame_figureFrame__3R17v",figureFrameCanDrag:"FigureFrame_figureFrameCanDrag__YDdgW",figureFrameDragging:"FigureFrame_figureFrameDragging__3lDNn",figureFrameIsResizing:"FigureFrame_figureFrameIsResizing__2KcP9",dot:"FigureFrame_dot__1bCjJ",dotLeftTop:"FigureFrame_dotLeftTop__3W6Fl",dotLeftBot:"FigureFrame_dotLeftBot__29eWD",dotRightTop:"FigureFrame_dotRightTop__3QZk2",dotRightBot:"FigureFrame_dotRightBot__qBpnC"}},7:function(e,t,n){e.exports={controlBar:"ControlBar_controlBar__2Cv_s",figureList:"ControlBar_figureList__oshKm",figure:"ControlBar_figure__fc4mo",nav:"ControlBar_nav__2_r_N",navLink:"ControlBar_navLink__1eed7",navLinkDisabled:"ControlBar_navLinkDisabled__3_-0y"}}},[[20,1,2]]]);
//# sourceMappingURL=main.d86fb1e5.chunk.js.map